<!doctype html>
<html lang="en-GB">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>D&D 5e Encounter Builder — Iteration 3</title>
		<link rel="stylesheet" href="styles.css" />
	</head>

	<body>
		<header class="site-header">
			<div class="container">
				<h1>
					D&amp;D 5e Encounter Builder <span class="badge">Iteration 3</span>
				</h1>
				<p class="subtitle">
					XP-balanced encounters with better variety and coherence (roles +
					stronger theme handling).
				</p>
			</div>
		</header>

		<main class="container">
			<section class="card">
				<h2>Inputs</h2>

				<form id="encounterForm" class="form-grid" autocomplete="off">
					<label class="field">
						<span class="label">Party level (1–10)</span>
						<input
							id="partyLevel"
							type="number"
							min="1"
							max="10"
							step="1"
							value="5"
							required
						/>
					</label>

					<label class="field">
						<span class="label">Party size (1–6)</span>
						<input
							id="partySize"
							type="number"
							min="1"
							max="6"
							step="1"
							value="4"
							required
						/>
					</label>

					<label class="field">
						<span class="label">Theme (monster type)</span>
						<select id="theme">
							<option value="any" selected>Any</option>
							<option value="beast">Beast</option>
							<option value="undead">Undead</option>
							<option value="humanoid">Humanoid</option>
							<option value="dragon">Dragon</option>
							<option value="fiend">Fiend</option>
							<option value="monstrosity">Monstrosity</option>
							<option value="aberration">Aberration</option>
							<option value="construct">Construct</option>
							<option value="elemental">Elemental</option>
							<option value="fey">Fey</option>
							<option value="giant">Giant</option>
							<option value="ooze">Ooze</option>
							<option value="plant">Plant</option>
							<option value="celestial">Celestial</option>
						</select>
					</label>

					<label class="field">
						<span class="label">Difficulty</span>
						<select id="difficulty">
							<option value="easy">Easy</option>
							<option value="medium" selected>Medium</option>
							<option value="hard">Hard</option>
							<option value="deadly">Deadly</option>
						</select>
					</label>

					<label class="field">
						<span class="label">Encounter style</span>
						<select id="style">
							<option value="any" selected>Any</option>
							<option value="skirmish">Skirmish (fast, mobile)</option>
							<option value="bruisers">Bruisers (tough frontline)</option>
							<option value="spellcasters">Spellcasters (magic-heavy)</option>
							<option value="swarm">Swarm (more bodies, weaker)</option>
						</select>
					</label>

					<label class="field checkbox-field">
						<span class="label">Variety</span>
						<div class="checkbox-row">
							<input id="preferVariety" type="checkbox" checked />
							<span>Prefer variety (avoid duplicates)</span>
						</div>
					</label>

					<div class="actions">
						<button id="generateBtn" type="submit" class="btn primary">
							Generate encounter
						</button>
						<button id="regenBtn" type="button" class="btn" disabled>
							Reroll
						</button>
					</div>
				</form>

				<p class="small muted">
					Iteration 3 keeps XP balancing, but scores encounters higher when they
					match your chosen style and keep variety.
				</p>
			</section>

			<!-- Mutually exclusive UI states -->
			<section id="loadingState" class="card state hidden" aria-live="polite">
				<h2>Generating…</h2>
				<p class="muted">
					Fetching monster data if needed, then searching for a high-quality
					encounter.
				</p>
				<div class="spinner" aria-hidden="true"></div>
			</section>

			<section id="errorState" class="card state hidden" aria-live="polite">
				<h2>Something went wrong</h2>
				<p id="errorMessage" class="error-text"></p>
				<div class="actions">
					<button id="retryBtn" class="btn primary" type="button">
						Try again
					</button>
				</div>
			</section>

			<section id="resultsState" class="results hidden">
				<article class="card">
					<div class="summary-header">
						<h2>Encounter Summary</h2>
						<span id="resultBadge" class="pill"></span>
					</div>

					<div id="summaryGrid" class="summary-grid"></div>
					<p id="summaryLine" class="summary-line"></p>
				</article>

				<article class="card">
					<div class="monsters-header">
						<h2>Monsters</h2>
						<span class="pill" id="countPill"></span>
					</div>
					<ul class="monster-list" id="monsterList"></ul>
				</article>
			</section>

			<!-- Details modal -->
			<dialog id="monsterModal" class="modal">
				<div class="modal-inner">
					<div class="modal-header">
						<h3 id="modalTitle">Monster</h3>
						<button id="closeModalBtn" class="icon-btn" aria-label="Close">
							✕
						</button>
					</div>
					<div id="modalBody" class="modal-body"></div>
					<div class="modal-footer">
						<a
							id="modalLink"
							class="btn primary"
							href="#"
							target="_blank"
							rel="noreferrer noopener"
							>View on Open5e</a
						>
						<button id="closeModalBtn2" class="btn" type="button">Close</button>
					</div>
				</div>
			</dialog>
		</main>

		<footer class="site-footer">
			<div class="container">
				<small class="muted"
					>Data source: Open5e. Iteration 3 adds composition quality only (no
					tactics/terrain/narrative).</small
				>
			</div>
		</footer>

		<script src="app.js"></script>
	</body>
</html>
